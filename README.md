# isONclust3
A rust implementation of a novel de novo clustering algorithm.
isONclust3 is a tool for clustering either PacBio Iso-Seq reads, or Oxford Nanopore reads into clusters, where each cluster represents all reads that came from a gene family. Output is a tsv file with each read assigned to a cluster-ID and a folder 'fastq' containing one fastq file per cluster generated. Detailed information is available in the isONclust3 paper.

# Table of contents
1. [Installation](#installation)
2. [Output](#output)
3. [Running isONclust3](#Running)
4. [Contact](#contact)
5. [Credits](#credits)
## Installation Guide <a name="installationguide"></a>
At the moment building from source is the only option to install the tool. This requires users to install the Rust programming language onto their system.
## Installing Rust <a name="installingrust"></a>
You can install rust via<br />

`curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh` (for macOS and Linux or other Unix-based OS). For Windows please follow the instructions on the following site: https://forge.rust-lang.org/infra/other-installation-methods.html .<br />
## Installation <a name="installation"></a>
After cloning the repository via `git clone https://github.com/aljpetri/isONclust3.git` use the following two commands to compile the code: <br />
`cd isONclust3` <br />
`cargo build --release` ( Compile the current package, the executable is then located in target/release) <br />

## Output <a name="output"></a>
#### Clustering information
The output consists of a tsv file `final_clusters.tsv` present in the specified output folder. In this file, the first column is the cluster ID and the second column is the read accession. For example:
```
0 read_X_acc
0 read_Y_acc
...
n read_Z_acc
```
if there are n reads there will be n rows. Some reads might be singletons.


## Running isONclust3 <a name="Running"></a>
IsONclust3 can be used on either Pacbio data or ONT data. 
### Oxford Nanopore reads
For ONT data isONclust3 requires a fastq file generated by an Oxford Nanopore basecaller.
To run the algorithm on ONT data:<br />
`{path to executable}/isONclust3 --fastq {input.fastq} --mode ont  --outfolder {outfolder}`
The `--mode ont` argument means setting `--k 13 --w 21`.
### Pacbio reads
IsONclust works with full-lengh non-chimeric (flnc) reads that has quality values assigned to bases. The flnc reads with quality values can be generated as follows:

   1. Make sure quality values is output when running the circular consensus calling step (CCS), by running ccs with the parameter --polish.
   2. Run PacBio's Iso-Seq pipeline step 2 and 3 (primer removal and extraction of flnc reads) [isoseq3](https://github.com/PacificBiosciences/IsoSeq).

To run the algorithm on Pacbio data:<br />
`{path to executable}/isONclust3 --fastq {input.fastq} --mode pacbio  --outfolder {outfolder}`
The `--mode pacbio` argument is equal to setting `--k 15 --w 51`.

 ## Contact <a name="contact"></a>
If you encounter any problems, please raise an issue on the issues page, you can also contact the developer of this repository via:
alexander.petri[at]math.su.se


## Credits <a name="credits"></a>
